# 步长区间功能说明 - 解决方案

## 问题描述

Excel中的样品编号为:
```
DX2523660101
DX2523660201
DX2523660301
DX2523660401
DX2523660501
DX2523660601
```

这些编号**每次递增100**,而不是递增1。

---

## ❌ 旧语法(不适用)

```
DX2523660(101-601)
```

这会展开为:
```
DX2523660101 ✅
DX2523660102 ❌
DX2523660103 ❌
...
DX2523660199 ❌
DX2523660200 ❌
DX2523660201 ✅
...
```

展开了501个编号,但只有6个能匹配!

---

## ✅ 新语法(正确)

### 格式:
```
前缀(起始-结束:步长)
```

### 示例:
```
DX2523660(101-601:100)
```

### 展开结果:
```
DX2523660101 ✅
DX2523660201 ✅
DX2523660301 ✅
DX2523660401 ✅
DX2523660501 ✅
DX2523660601 ✅
```

完美匹配! 🎉

---

## 语法对比

| 语法 | 步长 | 生成数量 | 示例展开 |
|------|------|---------|---------|
| `DX(01-05)` | 1(默认) | 5个 | 01, 02, 03, 04, 05 |
| `DX(01-05:2)` | 2 | 3个 | 01, 03, 05 |
| `DX(101-601:100)` | 100 | 6个 | 101, 201, 301, 401, 501, 601 |
| `DX(001-010:3)` | 3 | 4个 | 001, 004, 007, 010 |

---

## 使用方法

### 方式1: 对话框输入

选择"是" → 输入:
```
DX2523660(101-601:100)
```

### 方式2: TXT文件

创建 `samples.txt`:
```txt
# 批次1 - 步长100
DX2523660(101-601:100)

# 批次2 - 步长100  
DX2523670(101-401:100)

# 也可以单独列出
DX2523660701
DX2523660801
```

---

## 完整示例(针对你的Excel)

### Excel数据:
```
样品编号              浓度
DX2523660101        <0.004
DX2523660201        <0.004
DX2523660301        <0.004
DX2523660401        <0.004
DX2523660601        <0.004
```

### 输入:
```
DX2523660(101-601:100)
```

### 匹配结果:
```
✅ DX2523660101 - 匹配成功
✅ DX2523660201 - 匹配成功
✅ DX2523660301 - 匹配成功
✅ DX2523660401 - 匹配成功
❌ DX2523660501 - Excel中不存在(跳过)
✅ DX2523660601 - 匹配成功
```

### 输出Excel:
包含成功匹配的5行数据(501不存在所以不输出)

---

## 注意事项

### ✅ 正确用法

```
DX2523660(101-601:100)      ← 步长100
DX2523660(101-301:50)       ← 步长50
DX(01-10:2)                 ← 步长2
TEST(001-020:5)             ← 步长5
```

### ❌ 错误用法

```
DX2523660(101-601)          ← 缺少步长,会按步长1展开(501个)
DX2523660(101-601-100)      ← 错误格式,应该用冒号:
DX2523660(101-601:0)        ← 步长不能为0
DX2523660(101-601:-100)     ← 步长不能为负数
```

---

## 常见编号模式

### 1. 递增1(默认)
```
DX(01-05)  → DX01, DX02, DX03, DX04, DX05
```

### 2. 递增100
```
DX(101-601:100)  → DX101, DX201, DX301, DX401, DX501, DX601
```

### 3. 递增10
```
DX(010-050:10)  → DX010, DX020, DX030, DX040, DX050
```

### 4. 奇数编号
```
DX(01-09:2)  → DX01, DX03, DX05, DX07, DX09
```

### 5. 偶数编号
```
DX(02-10:2)  → DX02, DX04, DX06, DX08, DX10
```

---

## 测试命令

```powershell
python.exe .\main.py
```

### 测试步骤:

1. 选择包含Excel文件的文件夹
2. 选择"是"(直接输入)
3. 输入: `DX2523660(101-601:100)`
4. 查看输出,应该提取到5-6个样品数据

---

## 调试输出

程序会显示展开的编号:

```
待处理的样品编号（共 6 个）: DX2523660101, DX2523660201, DX2523660301, DX2523660401, DX2523660501, DX2523660601

符合条件的数据 (共 5 行):
* 行 0: ['DX2523660101', ...]
* 行 1: ['DX2523660201', ...]
* 行 2: ['DX2523660301', ...]
* 行 3: ['DX2523660401', ...]
* 行 4: ['DX2523660601', ...]
```

---

## 快速参考

| 你的需求 | 使用语法 |
|---------|---------|
| 101到601,每次+100 | `DX2523660(101-601:100)` |
| 1到10,每次+1 | `DX(1-10)` 或 `DX(1-10:1)` |
| 10到50,每次+10 | `DX(10-50:10)` |
| 只要奇数1,3,5,7,9 | `DX(1-9:2)` |

---

## 总结

✅ 使用 `DX2523660(101-601:100)` 而不是 `DX2523660(101-601)`  
✅ 步长参数用冒号 `:` 分隔  
✅ 步长必须大于0  
✅ 会自动跳过Excel中不存在的编号  
✅ 支持与普通编号混合使用
