# 区间语法最终方案说明

## 新语法设计

### 核心思想
**区间数字可以出现在编号的任意位置**

---

## 语法格式

```
前缀(起始-结束)后缀
```

- **前缀**: 区间前的部分(可以为空)
- **(起始-结束)**: 区间数字,按1递增
- **后缀**: 区间后的部分(可以为空)

---

## 使用示例

### 示例1: 中间数字变化(针对你的Excel)

**输入:**
```
DX2523660(1-6)01
```

**展开为:**
```
DX2523660101
DX2523660201
DX2523660301
DX2523660401
DX2523660501
DX2523660601
```

**说明:** 只有中间的一位数字从1变化到6,前后部分保持不变

---

### 示例2: 末尾数字变化

**输入:**
```
DX25095305(01-05)
```

**展开为:**
```
DX2509530501
DX2509530502
DX2509530503
DX2509530504
DX2509530505
```

---

### 示例3: 开头数字变化

**输入:**
```
(1-3)ABC
```

**展开为:**
```
1ABC
2ABC
3ABC
```

---

### 示例4: 纯区间(无前后缀)

**输入:**
```
(01-05)
```

**展开为:**
```
01
02
03
04
05
```

---

### 示例5: 复杂组合

**输入:**
```
TEST(1-3)ABC(01-02)
```

**展开为:**
```
TEST1ABC01
TEST2ABC01
TEST3ABC01
```

**注意:** 只支持一个区间,多个区间会被视为字面文本

---

## 自动补零

起始数字的位数决定了所有数字的位数:

| 输入 | 起始位数 | 展开结果 |
|------|---------|---------|
| `DX(1-12)` | 1位 | DX1, DX2, ..., DX9, DX10, DX11, DX12 |
| `DX(01-12)` | 2位 | DX01, DX02, ..., DX09, DX10, DX11, DX12 |
| `DX(001-012)` | 3位 | DX001, DX002, ..., DX009, DX010, DX011, DX012 |

---

## 实际应用场景

### 场景1: 你的Excel数据

**Excel中的编号:**
```
DX2523660101
DX2523660201
DX2523660301
DX2523660401
DX2523660601
```

**输入:**
```
DX2523660(1-6)01
```

**匹配结果:**
- ✅ DX2523660101 (匹配)
- ✅ DX2523660201 (匹配)
- ✅ DX2523660301 (匹配)
- ✅ DX2523660401 (匹配)
- ❌ DX2523660501 (Excel中不存在,自动跳过)
- ✅ DX2523660601 (匹配)

---

### 场景2: 平行样品

**输入:**
```
DX2509530101平行(1-3)
```

**展开为:**
```
DX2509530101平行1
DX2509530101平行2
DX2509530101平行3
```

---

### 场景3: 批量样品

**输入:**
```
DX252366(0-9)(1-9)01
```

**错误!** 不支持多个区间,会被当作普通编号处理

**正确做法:** 使用多个单区间
```
DX2523660(1-9)01
DX2523661(1-9)01
DX2523662(1-9)01
```

或使用逗号分隔:
```
DX2523660(1-6)01, DX2523670(1-6)01
```

---

## 对话框使用

选择"是" → 输入:
```
DX2523660(1-6)01
```

多个编号用逗号分隔:
```
DX2523660(1-6)01, DX2523670(1-4)01, DX2509530101
```

---

## TXT文件使用

创建 `samples.txt`:
```txt
# 批次A - 中间数字1到6
DX2523660(1-6)01

# 批次B - 中间数字1到4  
DX2523670(1-4)01

# 单独样品
DX2509530101
DX2509530201

# 平行样品
DX2509530301平行(1-2)
```

---

## 优势对比

### 旧方案(已废弃):
```
DX2523660(101-601:100)  ← 需要指定步长,容易出错
```

### 新方案:
```
DX2523660(1-6)01  ← 简单直观,一位数字变化
```

| 对比项 | 旧方案 | 新方案 |
|-------|--------|--------|
| 易读性 | ❌ 复杂 | ✅ 直观 |
| 灵活性 | ❌ 受限 | ✅ 灵活 |
| 错误率 | ❌ 容易算错步长 | ✅ 不易出错 |
| 通用性 | ❌ 只支持末尾 | ✅ 任意位置 |

---

## 注意事项

### ✅ 正确用法

```
DX2523660(1-6)01        ← 中间一位数字
ABC(1-9)XYZ             ← 开头数字
TEST(01-12)             ← 末尾数字,自动补零
Sample平行(1-3)         ← 平行样品
```

### ❌ 错误用法

```
DX(1-6-100)01           ← 错误格式,不支持步长参数
DX(1-6)(10-20)          ← 不支持多个区间
DX[1-6]01               ← 必须用圆括号()
DX(1~6)01               ← 必须用连字符-
```

---

## 快速参考

### 你的常用场景:

| 需求 | 输入语法 |
|------|---------|
| DX2523660101-601 | `DX2523660(1-6)01` |
| DX2523670101-401 | `DX2523670(1-4)01` |
| DX2509530101-105 | `DX25095301(01-05)` |
| 平行1到3 | `DX2509530101平行(1-3)` |

---

## 测试命令

```powershell
python.exe .\main.py
```

### 测试输入:
```
DX2523660(1-6)01
```

### 预期输出:
```
待处理的样品编号（共 6 个）: DX2523660101, DX2523660201, DX2523660301, DX2523660401, DX2523660501, DX2523660601
```

---

## 总结

✅ **简单直观**: `DX2523660(1-6)01` 一目了然  
✅ **灵活通用**: 区间可以在任意位置  
✅ **自动补零**: 保持数字位数一致  
✅ **智能匹配**: Excel中不存在的自动跳过  
✅ **易于理解**: 符合人类直觉的表达方式

这个方案完美解决了你的需求! 🎉
