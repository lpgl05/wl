# WL 提取脚本使用说明

本项目提供一个简单的 Excel 提取脚本，用于在一个文件夹下批量读取检测报表，并汇总指定样品编号（默认提取 DX2509530201 与 DX2509530301）的浓度结果。

## 运行环境

- Python 3.10+（项目设置为 >=3.13，低版本如 3.10/3.11 通常也可运行）
- 依赖：pandas、openpyxl

安装依赖（Windows PowerShell）：

```powershell
py -m pip install --upgrade pip
py -m pip install pandas openpyxl
```

## 如何运行

```powershell
py .\main.py
```

步骤：
1. 弹出对话框时，选择“0.953”对应的文件夹（其中包含多个以 0953- 开头的 Excel 文件）。
2. 程序会自动遍历该文件夹下所有 .xlsx/.xls 文件（忽略临时的 ~$.xlsx），
	- 在每个表中自动识别“样品编号”和“浓度”两列（会尝试多行标题），
	- 排除编号包含 KB/PS 的行，
	- 仅保留样品编号为 DX2509530201、DX2509530301 的记录（支持去除“平行1/2”等后缀并做规范化匹配）。
3. 选择保存位置，输出文件默认为：`汇总_0953_指定样品提取.xlsx`，包含列：项目名、样品编号、浓度。

## 常见问题

- 如果某些表的列名不一致（例如“样品名称”“浓度mg/L”等），脚本会自动尝试识别；若仍识别失败，终端会提示该表可用列名。
- 如果同一样品存在“平行1/平行2”等行且有空值，脚本会尝试用同组平行样品的浓度进行填充后再汇总。
- 若需要更换要提取的样品编号，可在 `main.py` 顶部的 `target_sample_ids` 列表中修改。

