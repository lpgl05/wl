# 区间语法功能说明

## 新增功能

支持使用**区间语法**快速输入连续的样品编号，无需逐个输入。

---

## 语法格式

```
前缀(起始数字-结束数字)
```

### 规则:
1. ✅ 起始和结束数字会**自动补零**,保持位数一致
2. ✅ 支持任意位数的数字(1位、2位、3位等)
3. ✅ 起始值必须 ≤ 结束值(如果反了会自动交换)
4. ✅ 可与普通编号混合使用
5. ✅ 文本框输入和TXT文件均支持

---

## 使用示例

### 示例1: 基本用法

**输入**:
```
DX25095305(01-05)
```

**自动展开为**:
```
DX2509530501
DX2509530502
DX2509530503
DX2509530504
DX2509530505
```

---

### 示例2: 混合输入

**输入**:
```
DX2509530201, DX25095303(01-03), DX2509530501
```

**自动展开为**:
```
DX2509530201
DX2509530301
DX2509530302
DX2509530303
DX2509530501
```

---

### 示例3: 单位数区间

**输入**:
```
ABC123(1-5)
```

**自动展开为**:
```
ABC1231
ABC1232
ABC1233
ABC1234
ABC1235
```

---

### 示例4: 三位数区间

**输入**:
```
TEST(001-005)
```

**自动展开为**:
```
TEST001
TEST002
TEST003
TEST004
TEST005
```

---

### 示例5: 平行样品区间

**输入**:
```
DX2509530101平行(1-3)
```

**自动展开为**:
```
DX2509530101平行1
DX2509530101平行2
DX2509530101平行3
```

---

### 示例6: 跨位数区间

**输入**:
```
XYZ(08-12)
```

**自动展开为**:
```
XYZ08
XYZ09
XYZ10
XYZ11
XYZ12
```

---

## 在对话框中使用

### 方式1: 直接输入

选择"是" → 在输入框中输入:

```
DX25095305(01-05), DX2509530701
```

支持分隔符:
- 逗号 `,`
- 空格
- 分号 `;`
- 换行

---

## 在TXT文件中使用

### 方式2: TXT文件导入

创建 `samples.txt`:

```txt
# 批次A - 使用区间语法
DX25095305(01-10)

# 批次B - 混合使用
DX2509530201
DX25095303(01-03)

# 平行样品
DX2509530101
DX2509530101平行(1-2)
```

选择"否" → 选择该TXT文件

---

## 注意事项

### ✅ 正确用法

```
DX25095305(01-05)     ← 正确
ABC123(1-9)           ← 正确
TEST(001-010)         ← 正确
Sample平行(1-3)       ← 正确
```

### ❌ 错误用法

```
DX25095305(1-05)      ← 错误: 位数不一致
DX25095305(05-01)     ← 警告: 会自动交换为(01-05)
DX25095305[01-05]     ← 错误: 必须用圆括号()
DX25095305(01~05)     ← 错误: 必须用连字符-
```

---

## 自动处理

### 1. 自动补零

输入的起始和结束数字会保持相同位数:

```
Input:  ABC(01-05)
Output: ABC01, ABC02, ABC03, ABC04, ABC05  ← 保持2位

Input:  XYZ(001-005)
Output: XYZ001, XYZ002, XYZ003, XYZ004, XYZ005  ← 保持3位
```

### 2. 自动交换

如果起始值大于结束值,会自动交换:

```
Input:  DX(05-01)
⚠ 警告: 区间起始值(5)大于结束值(1)，已自动交换
Output: DX01, DX02, DX03, DX04, DX05
```

### 3. 自动去重

展开后的编号会自动去重:

```
Input:  DX(01-03), DX02, DX(02-04)
Output: DX01, DX02, DX03, DX04  ← DX02 只出现一次
```

---

## 完整示例

### TXT文件内容:

```txt
# ================================
# 2025年10月批次样品
# ================================

# 常规样品 - 使用区间快速输入
DX25095301(01-10)
DX25095302(01-10)

# 特殊样品 - 单独列出
DX2509530301
DX2509530302

# 平行样品组
DX2509530101
DX2509530101平行(1-3)

DX2509530201
DX2509530201平行(1-2)

# QC样品
DX2509530QC(1-5)
```

### 展开后的编号总数:

- DX25095301(01-10) → 10个
- DX25095302(01-10) → 10个
- 特殊样品 → 2个
- 平行样品组1 → 4个 (主+3个平行)
- 平行样品组2 → 3个 (主+2个平行)
- QC样品 → 5个

**总计: 34个样品编号**

---

## 优势

✅ **快速输入**: 10个连续编号只需1行  
✅ **减少错误**: 避免手动输入每个编号时的拼写错误  
✅ **易于维护**: TXT文件中可读性更强  
✅ **灵活组合**: 区间和单个编号可混合使用  
✅ **自动补零**: 无需手动保持数字位数一致

---

## 测试命令

```powershell
python.exe .\main.py
```

测试区间展开:
1. 选择"是" → 输入 `DX25095305(01-05)`
2. 或选择"否" → 使用 `samples_example.txt`

查看程序输出,验证区间是否正确展开为多个样品编号。
