# 文件保存功能使用指南

## 📋 完整流程

### 1️⃣ 启动程序
```bash
python main.py
```

### 2️⃣ 选择Excel文件所在的文件夹
- 弹出文件夹选择对话框
- 选择包含待处理Excel文件的文件夹

### 3️⃣ 自动处理文件
程序会：
- ✅ 自动识别所有Excel文件
- ✅ 提取样品编号和浓度数据
- ✅ 处理平行样品
- ✅ 过滤符合条件的数据

### 4️⃣ 信息提示框
处理完成后，弹出信息框显示：

```
┌─────────────────────────────────────┐
│    保存提取结果                      │
├─────────────────────────────────────┤
│ 即将保存提取结果：                   │
│                                      │
│ 文件名: 汇总_提取结果.xlsx           │
│ 数据行数: 16 行                      │
│ 来源文件: 4 个                       │
│                                      │
│ 请选择保存位置...                    │
│                                      │
│              [ 确定 ]                │
└─────────────────────────────────────┘
```

### 5️⃣ 文件保存对话框
点击"确定"后，打开保存对话框：

```
┌─────────────────────────────────────────────┐
│ 保存汇总结果                          [ × ] │
├─────────────────────────────────────────────┤
│ 保存位置: 📁 D:\code\vscode\wl\data    [ ▼ ]│
│                                             │
│ 文件名: 汇总_提取结果.xlsx              [  ]│
│                                             │
│ 文件类型: Excel文件 (*.xlsx)          [ ▼ ]│
│                                             │
│                    [ 保存 ]  [ 取消 ]       │
└─────────────────────────────────────────────┘
```

**用户可以：**
- 🔄 更改保存位置
- ✏️ 修改文件名
- 📂 选择其他文件类型
- ✅ 点击"保存"确认
- ❌ 点击"取消"放弃保存

### 6️⃣ 保存成功提示

保存成功后，弹出确认框：

```
┌─────────────────────────────────────┐
│    保存成功                   [ i ] │
├─────────────────────────────────────┤
│ 提取结果已成功保存到:                │
│ D:\output\汇总_提取结果.xlsx         │
│                                      │
│              [ 确定 ]                │
└─────────────────────────────────────┘
```

同时控制台输出：
```
================================================================================
✅ 所有提取结果已汇总保存到: D:\output\汇总_提取结果.xlsx
   共提取 16 行数据，来自 4 个文件
================================================================================
```

---

## 🎯 功能特点

| 功能 | 说明 |
|------|------|
| **智能默认路径** | 自动使用选择的Excel文件夹作为初始保存位置 |
| **自定义文件名** | 可以修改默认的"汇总_提取结果.xlsx" |
| **灵活保存位置** | 可以选择任意文件夹保存结果 |
| **数据预览** | 保存前显示数据统计信息 |
| **操作确认** | 保存成功后有明确的提示 |
| **可取消操作** | 用户可以随时取消保存 |

---

## 💡 使用技巧

1. **快速保存**: 如果默认位置和文件名合适，直接点击"保存"
2. **重命名**: 可以添加日期等信息，如"汇总_提取结果_2025-10-14.xlsx"
3. **多次保存**: 取消后程序不会退出，可以重新运行保存到不同位置
4. **备份**: 可以保存多个副本到不同文件夹

---

## ⚠️ 注意事项

- ❗ 如果选择的保存路径已存在同名文件，会提示是否覆盖
- ❗ 确保有足够的磁盘空间
- ❗ 保存路径中避免使用特殊字符
- ❗ 点击"取消"后数据不会保存，需要重新运行程序

---

## 📊 输出文件结构

生成的Excel文件包含3列：

| 项目名 | 样品编号 | 浓度 |
|--------|---------|------|
| 总硬度 | DX2509530101 | 171 |
| 挥发酚 | DX2509530101 | <0.0003 |
| 氨氮 | DX2509530101 | <0.025 |
| ... | ... | ... |
